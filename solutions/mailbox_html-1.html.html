<p>```ruby
class Email
  def initialize(subject, headers)
    @subject = subject
    @headers = headers
  end</p>

<p>def subject
    @subject
  end</p>

<p>def date
    @headers[:date]
  end</p>

<p>def from
    @headers[:from]
  end
end</p>

<p>class Mailbox
  def initialize(name, emails)
    @name = name
    @emails = emails
  end</p>

<p>def name
    @name
  end</p>

<p>def emails
    @emails
  end
end</p>

<p>class MailboxHtmlFormatter
  def initialize(mailbox)
    @mailbox = mailbox
  end</p>

<p>def format
    tag(:html, [head, body].join(&quot;\n&quot;))
  end</p>

<p>def body
    tag(:body, [headline, table].join(&quot;\n&quot;))
  end</p>

<p>def headline
    tag(:h1, @mailbox.name)
  end</p>

<p>def table
    tag(:table, [thead, tbody].join(&quot;\n&quot;))
  end</p>

<p>def thead
    tag(:thead, ths.join(&quot;\n&quot;))
  end</p>

<p>def ths
    headers = [&quot;Date&quot;, &quot;From&quot;, &quot;Subject&quot;]
    headers.map { |content| tag(:th, content) }
  end</p>

<p>def tbody
    tag(:tbody, trs.join(&quot;\n&quot;))
  end</p>

<p>def trs
    rows.map { |row| tr(row) }
  end</p>

<p>def tr(row)
    tag(:tr, tds(row).join(&quot;\n&quot;))
  end</p>

<p>def tds(row)
    row.collect { |content| tag(:td, content) }
  end</p>

<p>def tag(name, content)
    content = &quot;\n#{content}\n&quot; unless [:h1, :td, :th].include?(name)
    html = &quot;&lt;#{name}&gt;#{content}&lt;/#{name}&gt;&quot;
    html = indent(html) unless name == :html
    html
  end</p>

<p>def indent(html)
    lines = html.split(&quot;\n&quot;)
    lines = lines.map { |line| &quot; &quot; * 2 + line }
    lines.join(&quot;\n&quot;)
  end</p>

<p>def rows
    @mailbox.emails.collect do |email|
      [email.date, email.from, email.subject]
    end
  end</p>

<p>def head
    &quot;<head>
      <style>
        table {
          border-collapse: collapse;
        }
        td, th {
          border: 1px solid black;
          padding: 1em;
        }
      </style>
    </head>&quot;
  end
end</p>

<p>emails = [
  Email.new(&quot;Homework this week&quot;, { :date =&gt; &quot;2014-12-01&quot;, :from =&gt; &quot;Ferdous&quot; }),
  Email.new(&quot;Keep on coding! :)&quot;, { :date =&gt; &quot;2014-12-01&quot;, :from =&gt; &quot;Dajana&quot; }),
  Email.new(&quot;Re: Homework this week&quot;, { :date =&gt; &quot;2014-12-02&quot;, :from =&gt; &quot;Ariane&quot; })
]
mailbox = Mailbox.new(&quot;Ruby Study Group&quot;, emails)
formatter = MailboxHtmlFormatter.new(mailbox)</p>

<p>puts formatter.format
```</p>
